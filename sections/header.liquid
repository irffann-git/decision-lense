{% liquid
  if section.settings.menu.links == blank
    assign main_menu_linklist = linklists[section.settings.menu].links
  else
    assign main_menu_linklist = section.settings.menu.links
  endif
%}

<div
  id="site-header"
  class="relative z-50"
  x-data="{ mobileMenuOpen: false, searchBarOpen: false }"
  x-cloak
  style="background-color: {{ section.settings.bg_color }};"
>

  <!-- MAIN HEADER -->
  <div class="max-w-7xl mx-auto px-1 sm:px-6">
    <div class="flex items-center justify-between py-2">
<div class="flex items-center gap-15">
      <!-- LOGO -->
      <div class="flex items-center">
        <a href="{{ routes.root_url }}">
          {% if section.settings.mobile_menu_logo %}
            <img src="{{ section.settings.mobile_menu_logo | image_url }}" width="" height="" class="h-10 w-auto">
          {% else %}
            <img src="{{ 'logo (3).png' | asset_url }}" width="" height="" class="h-10 w-auto">
          {% endif %}
        </a>
      </div>

      <!-- DESKTOP NAV -->
     <nav class="hidden  md:flex space-x-5 text-sm font-semibold text-gray-600">
  {% for link in main_menu_linklist %}
    {% if link.links != blank %}
      {% assign link_handle = link.handle | replace: '-', '_' %}

      <div class="relative" x-data="{ {{ link_handle }}: false }">
        <button
          x-on:click="{{ link_handle }} = !{{ link_handle }}"
          class="inline-flex items-center hover:text-black transition-colors duration-150" style="font-family:{{ section.settings.font_family }}"
        >
          {{ link.title }}
          {% render 'icon-dropdown' %}
        </button>

        <div
  x-show="{{ link_handle }}"
  @click.away="{{ link_handle }} = false"
  x-transition
  class="absolute z-20 mt-3 w-56 bg-white rounded-xl shadow-[0_8px_20px_rgba(0,0,0,0.1)] border border-gray-200 py-3 overflow-hidden backdrop-blur-sm"
>
  {% for childlink in link.links %}
   <a
  href="{{ childlink.url }}"
  class="block px-5 py-3 text-gray-700 hover:text-yellow-700 hover:bg-gray-50 transition-all duration-200 text-sm font-medium whitespace-nowrap"  style="font-family:{{ section.settings.font_family }}"
>
  {{ childlink.title }}
</a>

  {% endfor %}
</div>

      </div>

    {% else %}

      <a
        href="{{ link.url }}"
        class="text-gray-500 hover:text-black transition-colors duration-150"  style="font-family:{{ section.settings.font_family }}"
      >
        {{ link.title }}
      </a>

    {% endif %}
  {% endfor %}
</nav>

</div>
<div class="flex gap-1 sm:gap-4">
      <!-- RIGHT SIDE ICONS -->
      <div class="flex items-center gap-3 md:gap-6">

        <!-- SEARCH -->
       <a x-on:click="searchBarOpen = true"
   class="hover:text-black"
   style="color:{{ section.settings.icon_color }}">
  
  {% render 'icon-search' %}
  
</a>


        <!-- WISHLIST -->
      <a href="/pages/wishlist" class="hover:text-black" style="color:{{ section.settings.icon_color }}">
          {% render 'icon-favorite' %}
        </a>

        <!-- CART -->
        <a href="{{ routes.cart_url }}" class="hover:text-black" style="color:{{ section.settings.icon_color }}">
          {% render 'icon-shoping-cart' %}
        </a>

        <!-- VERTICAL LINE -->
        <div class="hidden lg:flex h-6 mx-3" style="border-left:1px solid #D9D9D9;"></div>

        <!-- HELP SECTION -->
        <div class="hidden lg:flex  items-center gap-2">
          <img src="{{ 'chat-icon.png' | asset_url }}" width="" height="" class="opacity-70" style="width:30px">

          <div class="flex flex-col text-right leading-tight">
            <span class="text-gray-600 text-sm"  style="font-family:{{ section.settings.font_family }}">Have any questions?</span>
            <span class="text-sm text-gray-600"  style="font-family:{{ section.settings.font_family }}">Free:
              <a 
  href="sms:{{ section.settings.ph-numebr | remove: ' ' }}" 
  class="font-semibold text-sm text-blue-700 hover:underline" style="font-family:{{ section.settings.font_family }}"
>
  {{ section.settings.ph-numebr }}
</a>

            </span>
          </div>
        </div>

      </div>

      <!-- MOBILE BUTTON -->
      <button x-on:click="mobileMenuOpen = true" class="md:hidden p-2">
        {% render 'icon-menu' %}
      </button>

    </div>
  </div>
  </div>

<!-- SEARCH BAR -->
<div x-show="searchBarOpen" class="w-full absolute top-0 left-0 bg-white border z-50">
    <!-- Close Button -->
    <button
      type="button"
      x-on:click="searchBarOpen = false"
      class="absolute top-4 right-4 text-red-500 hover:text-gray-700 focus:outline-none">
      {% render 'icon-close' %}
    </button>

    <!-- Search Form -->
    <div class="h-40 flex justify-center items-center">
      <form
        action="{{ routes.search_url }}"
        method="get"
        class="w-full max-w-md px-6">
        <div class="relative w-full text-gray-500">
          <input
            type="search"
            name="q"
            placeholder="Search sunglasses,eyelense......"
            class="w-full h-10 px-4 pr-12 rounded-full border border-yellow-600 text-sm focus:outline-none focus:ring-2 focus:ring-yellow-600 focus:border-yellow-600">
          <button type="submit" class="absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700">
            {% render 'icon-search' %}
          </button>
        </div>
      </form>
    </div>
  </div>






  <!-- ✔ MOBILE MENU SLIDES FROM RIGHT → LEFT -->
  <div
    x-show="mobileMenuOpen"
    x-transition.opacity
    class="fixed inset-0 bg-black/40 z-50 md:hidden"
    @click="mobileMenuOpen = false"
  >

    <!-- RIGHT PANEL -->
    <div
      class="absolute right-0 top-0 h-full w-4/5 max-w-xs bg-white shadow-xl p-6 overflow-y-auto"
      x-show="mobileMenuOpen"
      @click.stop
      x-transition:enter="transform transition ease-out duration-300"
      x-transition:enter-start="translate-x-full"
      x-transition:enter-end="translate-x-0"
      x-transition:leave="transform transition ease-in duration-300"
      x-transition:leave-start="translate-x-0"
      x-transition:leave-end="translate-x-full"
    >

      <!-- Mobile Header -->
      <div class="flex justify-between mb-6 gap-2">
        {% if section.settings.mobile_menu_logo %}
          <img src="{{ section.settings.mobile_menu_logo | image_url }}" width="" height="" class="h-full w-full">
        {% else %}
          <img
              src="{{ 'logo (3).png' |  asset_url }}"
              alt="{{ shop.name }}"
              width="500"
              height="200"
              class="h-10 w-auto object-contain">
        {% endif %}

        <button x-on:click="mobileMenuOpen = false" class="p-2 ml-3">
          {% render 'icon-close' %}
        </button>
      </div>

      <!-- Menu Links -->
      <div class="space-y-4">
        {% for link in main_menu_linklist %}
          {% if link.links == blank %}

            <a href="{{ link.url }}" class="block text-lg text-gray-700 hover:text-black"  style="font-family:{{ section.settings.font_family }}">
              {{ link.title }}
            </a>

          {% else %}
            <div x-data="{ open: false }">

              <button
                x-on:click="open = !open"
                class="w-full flex justify-between items-center text-lg text-gray-700" style="font-family:{{ section.settings.font_family }}"
              >
                {{ link.title }}
                <span x-bind:class="open ? 'rotate-180' : ''" class="transition-transform">
                  {% render 'icon-dropdown' %}
                </span>
              </button>

              <div
                x-show="open"
                x-transition
                class="pl-4 mt-2 space-y-2 border-r border-gray-300"
              >
                {% for sub in link.links %}
                  <a href="{{ sub.url }}" class="block text-gray-600 hover:text-black" style="font-family:{{ section.settings.font_family }}">
                    {{ sub.title }}
                  </a>
                {% endfor %}
              </div>

            </div>
          {% endif %}
        {% endfor %}
      </div>

    </div>

  </div>

</div>

<style>

  .wishlist-count-badge {
    position: absolute;
    top: -6px;
    right: -8px;
    background: #e60000;
    color: #fff;
    font-size: 11px;
    width: 17px;
    height: 17px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    font-weight: 700;
  }

  #site-header.is-sticky {
    position: fixed;
    top: 0; left: 0; right: 0;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    background: white;
  }
</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const header = document.getElementById("site-header");
    const offset = header.offsetTop;

    window.addEventListener("scroll", () => {
      if (window.scrollY > offset) {
        header.classList.add("is-sticky");
      } else {
        header.classList.remove("is-sticky");
      }
    });
  });
</script>

{% schema %}
{
  "name": "Header",
  "settings": [
    { "type": "color", "id": "bg_color", "label": "Baground color","default":"#fff" },
    {
  "type": "select",
  "id": "font_family",
  "label": "Font Family",
  "options": [
    { "value": "Outfit", "label": "Outfit" },
    { "value": "Poppins", "label": "Poppins" },
    { "value": "Inter", "label": "Inter" },
    { "value": "Roboto", "label": "Roboto" },
    { "value": "Montserrat", "label": "Montserrat" },
    { "value": "Lato", "label": "Lato" }
  ],
  "default": "Outfit"
},{ "type": "color" , "id": "icon_color" , "label": "icon color" , "default":"#0E2B5C"},
    { "type": "image_picker", "id": "mobile_menu_logo", "label": "Logo" },
    { "type": "link_list", "id": "menu", "label": "Menu", "default": "main-menu" },
    { "type": "text", "id": "ph-numebr", "label": "Phone Number", "default": "0712 819 79 555" }
  ]
}
{% endschema %}

{% liquid
  if section.settings.menu.links == blank
    assign main_menu_linklist = linklists[section.settings.menu].links
  else
    assign main_menu_linklist = section.settings.menu.links
  endif
%}

<div
  id="site-header"
  class="relative z-50"
  x-data="{ mobileMenuOpen: false, searchBarOpen: false }"
  x-cloak
  style="background-color: {{ section.settings.bg_color }};"
>
  <div
  x-show="searchBarOpen"
  x-transition.opacity
  class="header-blur-overlay"
></div>

  <!-- MAIN HEADER -->
  <div class="max-w-7xl mx-auto px-1 sm:px-6">
    <div class="flex items-center justify-between py-2">
<div class="flex items-center gap-15">
      <!-- LOGO -->
      <div class="flex items-center">
        <a href="{{ routes.root_url }}">
          {% if section.settings.mobile_menu_logo %}
            <img src="{{ section.settings.mobile_menu_logo | image_url }}" width="" height="" class="h-10 w-auto">
          {% else %}
            <img src="{{ 'logo (3).png' | asset_url }}" width="" height="" class="h-10 w-auto">
          {% endif %}
        </a>
      </div>

      <!-- DESKTOP NAV -->
     <nav class="hidden  md:flex space-x-5 text-sm font-semibold text-gray-600">
  {% for link in main_menu_linklist %}
    {% if link.links != blank %}
      {% assign link_handle = link.handle | replace: '-', '_' %}

      <div class="relative" x-data="{ {{ link_handle }}: false }">
        <button
          x-on:click="{{ link_handle }} = !{{ link_handle }}"
          class="inline-flex items-center hover:text-black transition-colors duration-150" style="font-family:{{ section.settings.font_family }}"
        >
          {{ link.title }}
          {% render 'icon-dropdown' %}
        </button>

        <div
  x-show="{{ link_handle }}"
  @click.away="{{ link_handle }} = false"
  x-transition
  class="absolute z-20 mt-3 w-56 bg-white rounded-xl shadow-[0_8px_20px_rgba(0,0,0,0.1)] border border-gray-200 py-3 overflow-hidden backdrop-blur-sm"
>
  {% for childlink in link.links %}
   <a
  href="{{ childlink.url }}"
  class="block px-5 py-3 text-gray-700 hover:text-yellow-700 hover:bg-gray-50 transition-all duration-200 text-sm font-medium whitespace-nowrap"  style="font-family:{{ section.settings.font_family }}"
>
  {{ childlink.title }}
</a>

  {% endfor %}
</div>

      </div>

    {% else %}

      <a
        href="{{ link.url }}"
        class="text-gray-500 hover:text-black transition-colors duration-150"  style="font-family:{{ section.settings.font_family }}"
      >
        {{ link.title }}
      </a>

    {% endif %}
  {% endfor %}
</nav>

</div>
<div class="flex gap-1 sm:gap-4">
      <!-- RIGHT SIDE ICONS -->
      <div class="flex items-center gap-3 md:gap-6">

        <!-- SEARCH -->
       <a x-on:click="searchBarOpen = true"
   class="hover:text-black"
   style="color:{{ section.settings.icon_color }}">
  
  {% render 'icon-search' %}
  
</a>


        <!-- WISHLIST -->
      <a href="/pages/wishlist" class="hover:text-black" style="color:{{ section.settings.icon_color }}">
          {% render 'icon-favorite' %}
        </a>

        <!-- CART -->
        <a href="{{ routes.cart_url }}" class="hover:text-black" style="color:{{ section.settings.icon_color }}">
          {% render 'icon-shoping-cart' %}
        </a>

        <!-- VERTICAL LINE -->
        <div class="hidden lg:flex h-6 mx-3" style="border-left:1px solid #D9D9D9;"></div>

        <!-- HELP SECTION -->
        <div class="hidden lg:flex  items-center gap-2">
          <img src="{{ 'chat-icon.png' | asset_url }}" width="" height="" class="opacity-70" style="width:30px">

          <div class="flex flex-col text-right leading-tight">
            <span class="text-gray-600 text-sm"  style="font-family:{{ section.settings.font_family }}">Have any questions?</span>
            <span class="text-sm text-gray-600"  style="font-family:{{ section.settings.font_family }}">Free:
              <a 
  href="sms:{{ section.settings.ph-numebr | remove: ' ' }}" 
  class="font-semibold text-sm text-blue-700 hover:underline" style="font-family:{{ section.settings.font_family }}"
>
  {{ section.settings.ph-numebr }}
</a>

            </span>
          </div>
        </div>

      </div>

      <!-- MOBILE BUTTON -->
      <button x-on:click="mobileMenuOpen = true" class="md:hidden p-2">
        {% render 'icon-menu' %}
      </button>

    </div>
  </div>
  </div>

<!-- SEARCH BAR -->
<div
  x-show="searchBarOpen"
  x-transition:enter="search-slide-enter"
  x-transition:enter-start="search-slide-enter-start"
  x-transition:enter-end="search-slide-enter-end"
  x-transition:leave="search-slide-leave"
  x-transition:leave-start="search-slide-leave-start"
  x-transition:leave-end="search-slide-leave-end"
  class="header-search-slide"
>

  <!-- Close Button -->
  <button
    type="button"
    x-on:click="searchBarOpen = false"
    class="search-close-btn">
    {% render 'icon-close' %}
  </button>

  <!-- Search Form -->
  <form
    action="{{ routes.search_url }}"
    method="get"
    class="search-slide-form">

    <div class="search-slide-input-wrap">

      <input
        type="search"
        name="q"
        placeholder="Search sunglasses, eyeglasses..."
        autocomplete="off"
        class="header-search-input">

      <button type="submit" class="search-submit-btn">
        {% render 'icon-search' %}
      </button>

      <!-- LIVE SUGGESTIONS -->
      <div
        id="header-search-suggestions"
        class="header-search-suggestions hidden">
      </div>

    </div>
  </form>
</div>








  <!-- ✔ MOBILE MENU SLIDES FROM RIGHT → LEFT -->
  <div
    x-show="mobileMenuOpen"
    x-transition.opacity
    class="fixed inset-0 bg-black/40 z-50 md:hidden"
    @click="mobileMenuOpen = false"
  >

    <!-- RIGHT PANEL -->
    <div
      class="absolute right-0 top-0 h-full w-4/5 max-w-xs bg-white shadow-xl p-6 overflow-y-auto"
      x-show="mobileMenuOpen"
      @click.stop
      x-transition:enter="transform transition ease-out duration-300"
      x-transition:enter-start="translate-x-full"
      x-transition:enter-end="translate-x-0"
      x-transition:leave="transform transition ease-in duration-300"
      x-transition:leave-start="translate-x-0"
      x-transition:leave-end="translate-x-full"
    >

      <!-- Mobile Header -->
      <div class="flex justify-between mb-6 gap-2">
        {% if section.settings.mobile_menu_logo %}
          <img src="{{ section.settings.mobile_menu_logo | image_url }}" width="" height="" class="h-full w-full">
        {% else %}
          <img
              src="{{ 'logo (3).png' |  asset_url }}"
              alt="{{ shop.name }}"
              width="500"
              height="200"
              class="h-10 w-auto object-contain">
        {% endif %}

        <button x-on:click="mobileMenuOpen = false" class="p-2 ml-3">
          {% render 'icon-close' %}
        </button>
      </div>

      <!-- Menu Links -->
      <div class="space-y-4">
        {% for link in main_menu_linklist %}
          {% if link.links == blank %}

            <a href="{{ link.url }}" class="block text-lg text-gray-700 hover:text-black"  style="font-family:{{ section.settings.font_family }}">
              {{ link.title }}
            </a>

          {% else %}
            <div x-data="{ open: false }">

              <button
                x-on:click="open = !open"
                class="w-full flex justify-between items-center text-lg text-gray-700" style="font-family:{{ section.settings.font_family }}"
              >
                {{ link.title }}
                <span x-bind:class="open ? 'rotate-180' : ''" class="transition-transform">
                  {% render 'icon-dropdown' %}
                </span>
              </button>

              <div
                x-show="open"
                x-transition
                class="pl-4 mt-2 space-y-2 border-r border-gray-300"
              >
                {% for sub in link.links %}
                  <a href="{{ sub.url }}" class="block text-gray-600 hover:text-black" style="font-family:{{ section.settings.font_family }}">
                    {{ sub.title }}
                  </a>
                {% endfor %}
              </div>

            </div>
          {% endif %}
        {% endfor %}
      </div>

    </div>

  </div>

</div>

<style>
  /* ===== HEADER BLUR OVERLAY ===== */

.header-blur-overlay {
  position: absolute;
  inset: 0;
  background: rgba(255, 255, 255, 0.4); /* light glass */
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  z-index: 55; /* below search, above header */
}


  .wishlist-count-badge {
    position: absolute;
    top: -6px;
    right: -8px;
    background: #e60000;
    color: #fff;
    font-size: 11px;
    width: 17px;
    height: 17px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
    font-weight: 700;
  }

  #site-header.is-sticky {
    position: fixed;
    top: 0; left: 0; right: 0;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    background: white;
  }

  /* ===== HEADER LIVE SEARCH ===== */
/* ===== SLIDING HEADER SEARCH ===== */

.header-search-slide {
  position: absolute;
  top: 0;
  right: 0;
  height: 64px;               /* header height */
  width: 420px;
  max-width: 90%;
  background: transparent;   /* bg venda */
  z-index: 60;
}

/* Alpine transitions */
.search-slide-enter {
  transition: transform 0.35s ease;
}
.search-slide-enter-start {
  transform: translateX(100%);
}
.search-slide-enter-end {
  transform: translateX(0);
}

.search-slide-leave {
  transition: transform 0.3s ease;
}
.search-slide-leave-start {
  transform: translateX(0);
}
.search-slide-leave-end {
  transform: translateX(100%);
}

/* FORM */
.search-slide-form {
  height: 100%;
  display: flex;
  align-items: center;
  padding-right: 44px;
}

/* INPUT WRAP */
.search-slide-input-wrap {
  position: relative;
  width: 100%;
}

/* INPUT */
.header-search-input {
  width: 100%;
  height: 40px;
  padding: 0 44px 0 16px;
  border-radius: 999px;
  border: 2px solid #ca8a04;
  font-size: 14px;
  outline: none;
  background: #fff;
}

/* SEARCH ICON */
.search-submit-btn {
  position: absolute;
  right: 10px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  cursor: pointer;
}

/* CLOSE BUTTON */
.search-close-btn {
  position: absolute;
  right: 8px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  cursor: pointer;
  color: #dc2626;
}

/* ================= HEADER SEARCH (FINAL) ================= */

.header-search-slide {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 520px;
  max-width: 92%;
  height: 56px;
  transform: translate(-50%, -50%);
  z-index: 60;
}

/* slide animation */
.search-slide-enter {
  transition: transform 0.4s ease;
}
.search-slide-enter-start {
  transform: translate(100%, -50%);
}
.search-slide-enter-end {
  transform: translate(-50%, -50%);
}
.search-slide-leave {
  transition: transform 0.3s ease;
}
.search-slide-leave-start {
  transform: translate(-50%, -50%);
}
.search-slide-leave-end {
  transform: translate(100%, -50%);
}

/* form */
.search-slide-form {
  height: 100%;
  display: flex;
  align-items: center;
}

/* input wrapper */
.search-slide-input-wrap {
  position: relative;
  width: 100%;
}

/* input */
.header-search-input {
  width: 100%;
  height: 48px;
  padding: 0 52px 0 20px;
  border-radius: 999px;
  border: 2px solid #ca8a04;
  font-size: 16px;
  background: #fff;
  outline: none;
}

/* submit icon */
.search-submit-btn {
  position: absolute;
  right: 14px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  cursor: pointer;
}

/* close button (desktop) */
.search-close-btn {
  position: absolute;
  right: -40px;
  top: 50%;
  transform: translateY(-50%);
  background: none;
  border: none;
  cursor: pointer;
  color: #dc2626;
}

/* ================= SUGGESTIONS ================= */

.header-search-suggestions {
  position: absolute;
  top: calc(100% + 10px);
  left: 0;
  width: 100%;
  background: #fff;
  border-radius: 14px;
  box-shadow: 0 15px 35px rgba(0,0,0,0.15);
  overflow: hidden;
  z-index: 70;
}

.header-search-suggestions.hidden {
  display: none;
}

.header-search-suggestions a {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 16px;
  text-decoration: none;
  color: #111;
  font-size: 14px;
}

.header-search-suggestions a:hover {
  background: #f9fafb;
}

.header-search-suggestions img {
  width: 38px;
  height: 38px;
  border-radius: 6px;
  object-fit: cover;
}

.header-suggest-title {
  font-weight: 600;
}

.header-suggest-type {
  font-size: 12px;
  color: #6b7280;
}

.header-collection-placeholder {
  width: 38px;
  height: 38px;
  background: #f3f4f6;
  border-radius: 6px;
  display: flex;
  align-items: center;
  justify-content: center;
}

/* ================= MOBILE (FINAL ALIGNMENT) ================= */
@media (max-width: 768px) {

  .header-search-slide {
    width: 92%;
  }

  .search-slide-form {
    width: 100%;
  }

  .search-slide-input-wrap {
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
  }

  /* INPUT */
  .header-search-input {
    flex: 1;
    height: 48px;         /* remove icon padding */
    box-sizing: border-box;
  }

  /* CLOSE BUTTON */
  .search-close-btn {
    position: absolute;
    right:2px;
    margin-top:-25px;
    width: 44px;
    height: 44px;
    flex-shrink: 0;
    transform: none;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
  }
}




</style>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    const header = document.getElementById("site-header");
    const offset = header.offsetTop;

    window.addEventListener("scroll", () => {
      if (window.scrollY > offset) {
        header.classList.add("is-sticky");
      } else {
        header.classList.remove("is-sticky");
      }
    });
  });
</script>


<script>
const headerInput = document.querySelector('.header-search-input');
const headerBox = document.getElementById('header-search-suggestions');
let headerController;

if (headerInput) {
  headerInput.addEventListener('input', function () {
    const query = this.value.trim();

    if (query.length < 2) {
      headerBox.classList.add('hidden');
      headerBox.innerHTML = '';
      return;
    }

    if (headerController) headerController.abort();
    headerController = new AbortController();

    fetch(`/search/suggest.json?q=${encodeURIComponent(query)}&resources[type]=product,collection&resources[limit]=6`, {
      signal: headerController.signal
    })
    .then(res => res.json())
    .then(data => {
      let html = '';

      /* PRODUCTS */
      data.resources.results.products.forEach(p => {
        html += `
          <a href="${p.url}">
            <img src="${p.image}" alt="${p.title}">
            <div>
              <div class="header-suggest-title">${p.title}</div>
              <div class="header-suggest-type">Product</div>
            </div>
          </a>`;
      });

      /* COLLECTIONS (NO IMAGE → PLACEHOLDER) */
      data.resources.results.collections.forEach(c => {
        html += `
          <a href="${c.url}">
            <div class="header-collection-placeholder">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="none">
                <rect x="3" y="3" width="7" height="7" stroke="currentColor" stroke-width="1.5"/>
                <rect x="14" y="3" width="7" height="7" stroke="currentColor" stroke-width="1.5"/>
                <rect x="3" y="14" width="7" height="7" stroke="currentColor" stroke-width="1.5"/>
                <rect x="14" y="14" width="7" height="7" stroke="currentColor" stroke-width="1.5"/>
              </svg>
            </div>
            <div>
              <div class="header-suggest-title">${c.title}</div>
              <div class="header-suggest-type">Collection</div>
            </div>
          </a>`;
      });

      if (!html) {
        html = `<div style="padding:14px;color:#6b7280;">No results found</div>`;
      }

      headerBox.innerHTML = html;
      headerBox.classList.remove('hidden');
    });
  });

  document.addEventListener('click', e => {
    if (!e.target.closest('.relative')) {
      headerBox.classList.add('hidden');
    }
  });
}
</script>

{% schema %}
{
  "name": "Header",
  "settings": [
    { "type": "color", "id": "bg_color", "label": "Baground color","default":"#fff" },
    {
  "type": "select",
  "id": "font_family",
  "label": "Font Family",
  "options": [
    { "value": "Outfit", "label": "Outfit" },
    { "value": "Poppins", "label": "Poppins" },
    { "value": "Inter", "label": "Inter" },
    { "value": "Roboto", "label": "Roboto" },
    { "value": "Montserrat", "label": "Montserrat" },
    { "value": "Lato", "label": "Lato" }
  ],
  "default": "Outfit"
},{ "type": "color" , "id": "icon_color" , "label": "icon color" , "default":"#0E2B5C"},
    { "type": "image_picker", "id": "mobile_menu_logo", "label": "Logo" },
    { "type": "link_list", "id": "menu", "label": "Menu", "default": "main-menu" },
    { "type": "text", "id": "ph-numebr", "label": "Phone Number", "default": "0712 819 79 555" }
  ]
}
{% endschema %}
